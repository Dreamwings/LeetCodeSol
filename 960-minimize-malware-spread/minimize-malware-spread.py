class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        
        ## S2: BFS
        ## Time: O(N^2)
        ## Space: O(N)
        def bfs(i):
            queue, visited = [i], [i]
            path_node = 0
            while(queue):
                cur = queue.pop(0)
                for idx, value in enumerate(graph[cur]):
                    
                    if value ==1 and idx not in visited:
                        queue.append(idx)
                        path_node += 1
                        if idx!= cur and idx in initial:
                            return -1
                        visited.append(idx)
            return path_node

        record = dict()

        for node in initial:
            record[node] = bfs(node)
        
        candidate = record[max(record, key=record.get)]
        
        res = []
        for k, v in record.items():
            if v==candidate:
                res.append(k)
        return min(res)
        
        """
        ## S1: Union Find
        ## Time: O(mnA(m*n)) where A is the ackerman function.
        ## Space: O(m*n)

        # there are [0, n-1] nodes
        # perform a union on all the n-1 nodes
        n = len(graph)
        parents = [i for i in range(n)]
        ranks = [1]*n
        def find(x):
            while x != parents[x]:
                x = parents[x]
            return x
        
        def union(x,y):
            x,y = find(x), find(y)
            if x != y:
                if ranks[x] > ranks[y]:
                    ranks[x] += ranks[y]
                    parents[y] = x
                else:
                    ranks[y] += ranks[x]
                    parents[x] = y

        for src in range(n):
            for dst in range(n):
                if src != dst and graph[src][dst]:
                    union(src, dst)

        infected = {}
        for cell in initial:
            fp = find(cell)
            parents[cell] = fp
            infected[fp] = infected.get(fp,0) + 1
        
        max_size, vertex = 0, min(initial)
        for cell in initial:
            if infected[parents[cell]] == 1:
                if ranks[parents[cell]] > max_size:
                    max_size = ranks[parents[cell]]
                    vertex = cell
                elif ranks[parents[cell]] == max_size and cell < vertex:
                    vertex = cell
        return vertex
        """